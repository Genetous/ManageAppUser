"use strict";(self.webpackChunkgenetous_manage_apps=self.webpackChunkgenetous_manage_apps||[]).push([[795,823],{4889:(e,t,a)=>{a.d(t,{QE:()=>u,Rd:()=>m,WX:()=>p,cO:()=>n,fq:()=>c,kS:()=>g});const s="http://localhost/authservice/",o="http://localhost/ruleservice/",n={applicationId:"c0e2b70d-ba03-450b-be3d-81dfaafcfae7",organizationId:"63d2ef2b85f6b0510e2e93d5"},i="1b7mo22u0pqr9t76dhhdezgct2vrhofoe6foexux4m27gta2",r={method:"POST",headers:{"Content-Type":"application/json",Authorization:""},body:""},c={GetConfigs:o+"/get/configs",AddConfigs:o+"/add/configuration",GetRules:o+"/get/rules",GetEncryption:o+"/get/encryption",AddEncryption:o+"/add/encryption",AddUpdateRules:o+"/add/methods",DeleteRule:o+"/delete/method",GetAppSecret:o+"/get/appSecret",LoginUser:o+"/login",GetApplications:o+"/applications",VerifyToken:s+"/verify",KillToken:s+"/logout",Auth:s+"/auth",Client:s+"/client"};async function l(e){localStorage.setItem("token",e)}async function d(){var e=Date.now();localStorage.setItem("timeout",e)}var p=function(){return new Promise((async function(e,t){try{var a=new Headers,s="";if(null==localStorage.getItem("token")||""==localStorage.getItem("token"))return void t(401);s="Bearer ".concat(localStorage.getItem("token")),a.append("Authorization",s),a.append("Content-Type","application/json");e((await fetch(c.VerifyToken,{method:"GET",headers:a})).status)}catch(o){t(o)}}))},g=function(){return new Promise((async function(e,t){try{var a=new Headers,s="";if(null==localStorage.getItem("token")||""==localStorage.getItem("token"))return void t(401);s="Bearer ".concat(localStorage.getItem("token"));var o={status:-1,message:""};a.append("Authorization",s),a.append("Content-Type","application/json");const r=await fetch(c.KillToken,{method:"POST",headers:a});var n=null;o.status=r.status;try{n=await r.json(),200!=r.status?(500==r.status?o.message="Unexpected Error Occured!":o.message=n.message,t(o)):e(n)}catch(i){o.message=i.message,t(o)}}catch(i){t(i)}}))},u=function(e,t){return new Promise((async function(a,s){try{r.body=JSON.stringify(n);const f=await fetch(c.Client,r);var o=await f.json();if(200!=f.status){var p={success:!1,message:o.message};return void s(p)}o.clientSecret=i,r.body=JSON.stringify(o);const I=await fetch(c.Auth,r),y=await I.json();if(200!=I.status){p={success:!1,message:y.message};return void s(p)}if(0===t){var g=new Headers,m="Bearer "+y.token;g.append("Authorization",m),g.append("Content-Type","application/json");const t=await fetch(c.LoginUser,{method:"POST",headers:g,body:JSON.stringify(e)}),o=await t.json();if(200!=t.status){p={success:!1,message:o.message};s(p)}if(!(o.results.length>0)){p={success:!1,message:o.message};return void s(p)}var h=o.results[0].data[0];if(null==h)return void s(p={success:!1,message:"No user found!"});!async function(e){localStorage.setItem("orgId",e)}(h.collectionId),n.clientId=h.related.user[0]._id,await u(n,1).then((function(e){a(e)}),(e=>{s({success:!1,message:e})}))}else{l(y.token),d(),localStorage.setItem("clientId",n.clientId),localStorage.setItem("organizationId",n.organizationId),localStorage.setItem("applicationId",n.applicationId),a(p={success:!0,message:""})}}catch(f){console.log(f),s(p={success:!1,message:f})}}))},m=function(e,t){return new Promise((async function(a,s){try{var o=new Headers,n="";if(null==localStorage.getItem("token")||""==localStorage.getItem("token"))return void s(401);n="Bearer ".concat(localStorage.getItem("token")),o.append("Authorization",n),o.append("Content-Type","application/json");var i={status:-1,message:""};const l=await fetch(t,{method:"POST",headers:o,body:JSON.stringify(e)});var r=null;i.status=l.status;try{r=await l.json(),200!=l.status?(500==l.status?i.message="Unexpected Error Occured!":i.message=r.message,s(i)):a(r)}catch(c){i.message=c.message,s(i)}}catch(c){s(c)}}))}},5091:(e,t,a)=>{a.r(t),a.d(t,{Applications:()=>m,default:()=>h});var s=a(2791),o=a(4846),n=a(710),i=a(4889),r=a(9642),c=a(4880),l=a(1523),d=a(577),p=(a(5462),a(8983)),g=a(184);var u="Unexpected Error Occured!";class m extends s.Component{constructor(e){super(e),this.state={applications:[],modalVisible:!1,file:[],application:{collectionName:"application",content:{applicationName:"",applicationIcon:"",applicationCreatedDate:0,uniqueFields:["applicationName"]}},redirect:!1,appCreateStarted:!1}}handleRedirect(){this.state.redirect||this.setState({redirect:!0})}componentDidMount(){this.getApplications()}async getApplications(){var e={where:{and:{relationName:"organizationRelations",collectionId:localStorage.getItem("orgId")}},related:{collectionName:"application",sort:{applicationName:"asc"}}},t=[...this.state.applications],a=!0;if(await(0,i.Rd)(e,i.fq.GetApplications).then((function(e){e.results.length>0&&e.results[0].data.length>0&&(t=e.results[0].data[0].related.application)}),(e=>{401==e.status?this.handleRedirect():(a=!1,u=e.message)})),!a){var s=a?"success":"error";this.toastShow(s,u)}this.setState({applications:t})}toastShow(e,t){switch(e){case"success":d.Am.success(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:d.Mi});break;case"error":d.Am.error(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:d.Mi});break;case"info":d.Am.info(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:d.Mi})}}appItemChange(e){const{application:t}=this.state;t.content[e.target.name]=e.target.value,this.setState({application:t})}async fileChanged(e){if(e.target.files.length>0){var t=e.target.files;t.length>0&&await this.setState({file:t})}else await this.setState({file:[]})}setModalVisible(e,t){this.setState({modalVisible:e})}async deleteApp(e){var t={where:{or:{id:[e]}}};return await(0,i.Rd)(t,i.fq.DeleteCollection).then((function(e){}),(e=>{})),!0}setAppID(e,t){localStorage.setItem("appId",e.target.name)}async logOut(e){var t=!1;return await(0,i.kS)().then((function(e){t=!0}),(e=>{401==e.status?t=!0:u=e.message})),t?(localStorage.removeItem("token"),localStorage.removeItem("clientId"),localStorage.removeItem("organizationId"),localStorage.removeItem("applicationId"),localStorage.removeItem("appId"),localStorage.removeItem("orgId"),delete i.cO.clientId,this.setState({redirect:!0})):this.toastShow("error",u),!1}toastShow(e,t){switch(e){case"success":d.Am.success(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:d.Mi});break;case"error":d.Am.error(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:d.Mi});break;case"info":d.Am.info(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:d.Mi})}}render(){const{redirect:e}=this.state;return e?(0,g.jsx)(c.l_,{to:"/login"}):(0,g.jsxs)(p.KB,{className:"p-5",children:[(0,g.jsx)(d.Ix,{}),(0,g.jsx)(p.rb,{className:"justify-content-center",children:(0,g.jsx)(p.b7,{className:"text-center p-5",children:(0,g.jsxs)(p.tj,{children:["OrganizationId : ",localStorage.getItem("orgId")]})})}),(0,g.jsx)(p.rb,{className:"justify-content-center",children:this.state.applications.map(((e,t)=>(0,g.jsx)(p.b7,{sm:3,children:(0,g.jsx)(p.xH,{className:"text-center",children:(0,g.jsxs)(p.sl,{children:[(0,g.jsx)(p.tj,{children:e.content.applicationName}),(0,g.jsxs)(p.uS,{children:["ApplicationId : ",e.content.applicationId]}),(0,g.jsxs)(p.uS,{children:["Created Date : ",(0,r.Z)(e.content.applicationCreatedDate,"dd.MM.yyyy")]}),(0,g.jsx)(l.rU,{to:"/",name:e.content.applicationId,onClick:this.setAppID.bind(this),children:(0,g.jsx)(p.u5,{name:e.content.applicationId,href:"#",children:"Go to Panel"})})]})})})))}),(0,g.jsx)(p.rb,{className:"justify-content-center",children:(0,g.jsx)(p.b7,{className:"text-center p-5",children:(0,g.jsxs)(p.u5,{onClick:this.logOut.bind(this),children:[(0,g.jsx)(o.Z,{icon:n.V})," Logout "]})})})]})}}const h=m},710:(e,t,a)=>{a.d(t,{V:()=>s});const s=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='77.155 272.034 351.75 272.034 351.75 272.033 351.75 240.034 351.75 240.033 77.155 240.033 152.208 164.98 152.208 164.98 152.208 164.979 129.58 142.353 15.899 256.033 15.9 256.034 15.899 256.034 129.58 369.715 152.208 347.088 152.208 347.087 152.208 347.087 77.155 272.034' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='160 16 160 48 464 48 464 464 160 464 160 496 496 496 496 16 160 16' class='ci-primary'/>"]}}]);
//# sourceMappingURL=795.eb7af7ca.chunk.js.map