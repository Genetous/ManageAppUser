"use strict";(self.webpackChunkgenetous_manage_apps=self.webpackChunkgenetous_manage_apps||[]).push([[320],{4889:(e,t,s)=>{s.d(t,{QE:()=>m,Rd:()=>g,WX:()=>d,cO:()=>n,fq:()=>c,kS:()=>p});const a="http://localhost/authservice/",r="http://localhost/ruleservice/",n={applicationId:"c0e2b70d-ba03-450b-be3d-81dfaafcfae7",organizationId:"63d2ef2b85f6b0510e2e93d5"},o="1b7mo22u0pqr9t76dhhdezgct2vrhofoe6foexux4m27gta2",i={method:"POST",headers:{"Content-Type":"application/json",Authorization:""},body:""},c={GetConfigs:r+"/get/configs",AddConfigs:r+"/add/configuration",GetRules:r+"/get/rules",GetEncryption:r+"/get/encryption",AddEncryption:r+"/add/encryption",AddUpdateRules:r+"/add/methods",DeleteRule:r+"/delete/method",GetAppSecret:r+"/get/appSecret",LoginUser:r+"/login",GetApplications:r+"/applications",VerifyToken:a+"/verify",KillToken:a+"/logout",Auth:a+"/auth",Client:a+"/client"};async function l(e){localStorage.setItem("token",e)}async function u(){var e=Date.now();localStorage.setItem("timeout",e)}var d=function(){return new Promise((async function(e,t){try{var s=new Headers,a="";if(null==localStorage.getItem("token")||""==localStorage.getItem("token"))return void t(401);a="Bearer ".concat(localStorage.getItem("token")),s.append("Authorization",a),s.append("Content-Type","application/json");e((await fetch(c.VerifyToken,{method:"GET",headers:s})).status)}catch(r){t(r)}}))},p=function(){return new Promise((async function(e,t){try{var s=new Headers,a="";if(null==localStorage.getItem("token")||""==localStorage.getItem("token"))return void t(401);a="Bearer ".concat(localStorage.getItem("token"));var r={status:-1,message:""};s.append("Authorization",a),s.append("Content-Type","application/json");const i=await fetch(c.KillToken,{method:"POST",headers:s});var n=null;r.status=i.status;try{n=await i.json(),200!=i.status?(500==i.status?r.message="Unexpected Error Occured!":r.message=n.message,t(r)):e(n)}catch(o){r.message=o.message,t(r)}}catch(o){t(o)}}))},m=function(e,t){return new Promise((async function(s,a){try{i.body=JSON.stringify(n);const f=await fetch(c.Client,i);var r=await f.json();if(200!=f.status){var d={success:!1,message:r.message};return void a(d)}r.clientSecret=o,i.body=JSON.stringify(r);const y=await fetch(c.Auth,i),v=await y.json();if(200!=y.status){d={success:!1,message:v.message};return void a(d)}if(0===t){var p=new Headers,g="Bearer "+v.token;p.append("Authorization",g),p.append("Content-Type","application/json");const t=await fetch(c.LoginUser,{method:"POST",headers:p,body:JSON.stringify(e)}),r=await t.json();if(200!=t.status){d={success:!1,message:r.message};a(d)}if(!(r.results.length>0)){d={success:!1,message:r.message};return void a(d)}var h=r.results[0].data[0];if(null==h)return void a(d={success:!1,message:"No user found!"});!async function(e){localStorage.setItem("orgId",e)}(h.collectionId),n.clientId=h.related.user[0]._id,await m(n,1).then((function(e){s(e)}),(e=>{a({success:!1,message:e})}))}else{l(v.token),u(),localStorage.setItem("clientId",n.clientId),localStorage.setItem("organizationId",n.organizationId),localStorage.setItem("applicationId",n.applicationId),s(d={success:!0,message:""})}}catch(f){console.log(f),a(d={success:!1,message:f})}}))},g=function(e,t){return new Promise((async function(s,a){try{var r=new Headers,n="";if(null==localStorage.getItem("token")||""==localStorage.getItem("token"))return void a(401);n="Bearer ".concat(localStorage.getItem("token")),r.append("Authorization",n),r.append("Content-Type","application/json");var o={status:-1,message:""};const l=await fetch(t,{method:"POST",headers:r,body:JSON.stringify(e)});var i=null;o.status=l.status;try{i=await l.json(),200!=l.status?(500==l.status?o.message="Unexpected Error Occured!":o.message=i.message,a(o)):s(i)}catch(c){o.message=c.message,a(o)}}catch(c){a(c)}}))}},8444:(e,t,s)=>{s.r(t),s.d(t,{Login:()=>O,default:()=>z});var a=s(2791),r=s(4880),n=s(1523),o=s(4889),i=s(577),c=(s(5462),s(2007)),l=s.n(c),u=["color","size","title"];function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},d.apply(this,arguments)}function p(e,t){if(null==e)return{};var s,a,r=function(e,t){if(null==e)return{};var s,a,r={},n=Object.keys(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var m=(0,a.forwardRef)((function(e,t){var s=e.color,r=e.size,n=e.title,o=p(e,u);return a.createElement("svg",d({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:s},o),n?a.createElement("title",null,n):null,a.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"}),a.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"}))}));m.propTypes={color:l().string,size:l().oneOfType([l().string,l().number]),title:l().string},m.defaultProps={color:"currentColor",size:"1em",title:null};const g=m;var h=["color","size","title"];function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},f.apply(this,arguments)}function y(e,t){if(null==e)return{};var s,a,r=function(e,t){if(null==e)return{};var s,a,r={},n=Object.keys(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)s=n[a],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var v=(0,a.forwardRef)((function(e,t){var s=e.color,r=e.size,n=e.title,o=y(e,h);return a.createElement("svg",f({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:s},o),n?a.createElement("title",null,n):null,a.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"}),a.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"}),a.createElement("path",{d:"M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"}))}));v.propTypes={color:l().string,size:l().oneOfType([l().string,l().number]),title:l().string},v.defaultProps={color:"currentColor",size:"1em",title:null};const j=v;var w=s(8983),x=s(4846);const b=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M411.6,343.656l-72.823-47.334,27.455-50.334A80.23,80.23,0,0,0,376,207.681V128a112,112,0,0,0-224,0v79.681a80.236,80.236,0,0,0,9.768,38.308l27.455,50.333L116.4,343.656A79.725,79.725,0,0,0,80,410.732V496H448V410.732A79.727,79.727,0,0,0,411.6,343.656ZM416,464H112V410.732a47.836,47.836,0,0,1,21.841-40.246l97.66-63.479-41.64-76.341A48.146,48.146,0,0,1,184,207.681V128a80,80,0,0,1,160,0v79.681a48.146,48.146,0,0,1-5.861,22.985L296.5,307.007l97.662,63.479h0A47.836,47.836,0,0,1,416,410.732Z' class='ci-primary'/>"],I=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M384,200V144a128,128,0,0,0-256,0v56H88V328c0,92.635,75.364,168,168,168s168-75.365,168-168V200ZM160,144a96,96,0,0,1,192,0v56H160ZM392,328c0,74.99-61.01,136-136,136s-136-61.01-136-136V232H392Z' class='ci-primary'/>"];var S=s(184);class O extends a.Component{constructor(e){super(e),this.state={username:"",userpass:"",redirect:!1,spinner:!0,eyes:{userpassEye:!1},types:{userpassEye:"password"}}}changeEye(e,t){t.preventDefault;var s={...this.state.eyes},a={...this.state.types};return s[e]=1!=s[e],a[e]=1==s[e]?"text":"password",this.setState({eyes:s,types:a}),!1}change(e){this.state[e.target.name]=e.target.value,this.setState()}componentDidMount(){this.verify()}async verify(){var e=!1;await(0,o.WX)().then((function(t){200==t?e=!0:(localStorage.removeItem("token"),localStorage.removeItem("clientId"),localStorage.removeItem("organizationId"),localStorage.removeItem("applicationId"),localStorage.removeItem("appId"),localStorage.removeItem("orgId"))}),(e=>{localStorage.removeItem("token"),localStorage.removeItem("clientId"),localStorage.removeItem("organizationId"),localStorage.removeItem("applicationId"),localStorage.removeItem("appId"),localStorage.removeItem("orgId")})),this.setState({redirect:e})}async login(e){e.preventDefault(),await this.setState({spinner:!1});var t,s={where:{and:{relationName:"organizationRelations",isActive:!0}},related:{collectionName:"user",where:{and:{username:this.state.username,userpass:this.state.userpass,isActive:!0}}}},a=!1,r=!1;await(0,o.QE)(s,0).then((function(e){1==e.success?a=!0:t=e.message}),(e=>{t=e.message})),a||(i.Am.error(t,{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,theme:"dark",transition:i.Mi}),r=!0),this.setState({redirect:a,spinner:r})}render(){const{redirect:e}=this.state;return e?(0,S.jsx)(r.l_,{to:"/applications"}):(0,S.jsx)("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center",children:(0,S.jsxs)(w.KB,{children:[(0,S.jsx)(i.Ix,{}),(0,S.jsx)(w.rb,{className:"justify-content-center",children:(0,S.jsx)(w.b7,{md:4,children:(0,S.jsx)(w.dL,{children:(0,S.jsx)(w.xH,{className:"p-4",children:(0,S.jsx)(w.sl,{children:(0,S.jsxs)(w.lx,{onSubmit:this.login.bind(this),children:[(0,S.jsx)("h1",{children:"Login"}),(0,S.jsx)("p",{className:"text-medium-emphasis",children:"Sign In to your account"}),(0,S.jsxs)(w.YR,{className:"mb-3",children:[(0,S.jsx)(w.wV,{children:(0,S.jsx)(x.Z,{icon:b})}),(0,S.jsx)(w.jO,{placeholder:"Username",required:!0,name:"username",onChange:this.change.bind(this)})]}),(0,S.jsxs)(w.YR,{className:"mb-3",children:[(0,S.jsx)(w.wV,{children:(0,S.jsx)(x.Z,{icon:I})}),(0,S.jsx)(w.jO,{type:this.state.types.userpassEye,required:!0,placeholder:"Password",autoComplete:"current-password",name:"userpass",onChange:this.change.bind(this)}),(0,S.jsx)(w.wV,{className:"p-0",children:(0,S.jsxs)("button",{type:"button",className:"btn btn-link",onClick:this.changeEye.bind(this,"userpassEye"),children:[this.state.eyes.userpassEye&&(0,S.jsx)(g,{})," ",!this.state.eyes.userpassEye&&(0,S.jsx)(j,{})]})})]}),(0,S.jsx)(w.rb,{className:"justify-content-center",children:(0,S.jsx)(w.b7,{className:"text-center d-grid gap-2 col-6 mx-auto",md:6,children:(0,S.jsxs)(w.u5,{color:"primary",type:"submit",size:"lg",disabled:!this.state.spinner,children:[(0,S.jsx)(w.LQ,{component:"span",size:"sm",variant:"grow","aria-hidden":"true",hidden:this.state.spinner,className:"mx-1"}),"Login"]})})}),(0,S.jsx)(w.rb,{className:"justify-content-center",children:(0,S.jsx)(w.b7,{xs:6,className:"text-center",children:(0,S.jsx)(n.rU,{to:"/forgot",children:(0,S.jsx)(w.u5,{color:"link",className:"px-0",children:"Forgot password?"})})})})]})})})})})})]})})}}const z=O}}]);
//# sourceMappingURL=320.0afc0b7f.chunk.js.map